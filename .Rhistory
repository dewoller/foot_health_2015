if (isOpen(Tfile, "r")) {
seek(Tfile, 0, rw = "r")
lines = readLines(Tfile)
close(Tfile)
}
skipPos = grep("Entry", lines[1:22])[1]
startTPos = grep("Start Time", lines[1:22])
startTime = gsub("Start Time,", "", lines[startTPos])
startTime = gsub(",", " ", startTime)
startline = skipPos + 1
endline = length(lines)
rawdata = c()
for (i in startline:endline) {
rawdata = c(rawdata, strsplit(lines[i], ",") [[1]][6])
}
timeline = rep(0:as.integer(length(rawdata)-1))*60
rst = timeline + as.POSIXlt(startTime, tz="", "%m/%d/%Y %H:%M:%S")
data.frame(TimeStamp = rst, counts = as.numeric(as.vector(rawdata)))
}
a=readCountsDataRT3("test.csv")
head(a)
source('/mnt/raid/home/dewoller/mydoc/research/noraShields/projects/foot_health_2015/functions.R')
b=wearingMarking(a)
head(a)$TimeStamp
head(a)$TimeStamp[1]
strptime(head(a)$TimeStamp[1], "%Y")
strptime(head(a)$TimeStamp[1], "%y")
as.character(head(a)$TimeStamp[1], "%y")
as.character(head(a)$TimeStamp[1], "%Y")
as.character(head(a)$TimeStamp[1], "%Y-%M")
as.character(head(a)$TimeStamp[1], "%Y-%m")
as.character(head(a)$TimeStamp[1], "%Y-%m-%d")
as.character(head(a)$TimeStamp[1], "%Y-%m-%d %H:%M:%S")
source('/mnt/raid/home/dewoller/mydoc/research/noraShields/projects/foot_health_2015/functions.R')
a=readCountsDataRT3("test.csv")
str(a)
source('/mnt/raid/home/dewoller/mydoc/research/noraShields/projects/foot_health_2015/functions.R')
a=readCountsDataRT3("test.csv")
str(a)
b=wearingMarking(a)
source('/code/noraShields/projects/foot_health_2015/load.R')
traceback()
options(error=recover)
source('/code/noraShields/projects/foot_health_2015/load.R')
b=wearingMarking(a)
head(ts)
head(TS)
TS
0
source('/code/noraShields/projects/foot_health_2015/functions.R')
source('/mnt/raid/home/dewoller/mydoc/research/noraShields/projects/foot_health_2015/functions.R')
a=readCountsDataRT3("test.csv")
source('~/.active-rstudio-document', echo=TRUE)
b=wearingMarking(a)
head(b)
str(b)
b=wearingMarking(a, perMinuteCts=1)
str(b)
as.factor(b$weekday)
str(b)
source('/code/noraShields/projects/foot_health_2015/load.R', echo=TRUE)
library("PhysicalActivity");
source("functions.R")
a=readCountsDataRT3("test.csv")
head(b)
(a)
b=wearingMarking(a, perMinuteCts=1)
head(b)
levels(as.factor(b$w))
levels(as.factor(b$wearing))
dataset=a
frame = 90,
perMinuteCts = 60,
TS = "TimeStamp",
cts = "counts",
streamFrame = NULL,
allowanceFrame= 2,
newcolname = "wearing",
getMinuteMarking = FALSE,
dayStart = "00:00:00",
dayEnd = "23:59:59",
)
b=wearingMarking(a,
)
perMinuteCts=1
frame = 90
,
perMinuteCts = 60
,
TS = "TimeStamp"
,
cts = "counts"
,
streamFrame = NULL
,
allowanceFrame= 2
,
newcolname = "wearing"
,
getMinuteMarking = FALSE
,
dayStart = "00:00:00"
,
dayEnd = "23:59:59"
,
...)
perMinuteCts=1
if(perMinuteCts != 1){
#not a minute data run collapse
data2 = dataCollapser(dataset, TS=TS, by = 60, col = cts, ...)
}else{
data2 = dataset
}
cat("frame is ", frame, "\n")
cat("streamFrame is ", streamFrame, "\n")
cat("allowanceFrame is ", allowanceFrame, "\n")
ct = as.vector(dataset[,names(dataset) == cts])
if(is.null(streamFrame)){
streamFrame = round(0.5*frame)
}
#all the NA's in the original counts data will be treated as 0 counts
ct1 = ct
ct[is.na(ct)] = 0
size = dim(dataset)[1]
wearing = rep("nw", size)
ct_bool = ct > 0
rowPos = nthOccurance (dataVct = ct_bool, value= TRUE)
library("PhysicalActivity");
rowPos = nthOccurance (dataVct = ct_bool, value= TRUE)
source("PhysicalActivity/R/nthOccurance.R")
rowPos = nthOccurance (dataVct = ct_bool, value= TRUE)
head(rowPos)
head(ct_bool)
str(rowPos)
str(ct_bool)
startpos = rowPos[1]
endpos = c()
prev = TRUE
for(q  in 2: (length(rowPos)))
{
if(prev)
{
if( rowPos[q] - rowPos[q-1]>1 )
{
endpos = c(endpos, rowPos[q-1])
startpos = c(startpos, rowPos[q])
}
}
else
{
startpos = c(startpos, rowPos[q])
prev = TRUE
}
if(q == length(rowPos))
{endpos = c(endpos, rowPos[q])}
}#end of q
len(endpos)
str(endpos)
str(startpos)
head(ct_bool)
allowancewin = endpos-startpos
head(allowancewin)
source('/mnt/raid/home/dewoller/mydoc/research/noraShields/projects/foot_health_2015/functions.R')
source("/home/dewoller/mydoc/research/noraShields/students/carlon/stats/func.R")
markingStandard=b
markingCarlon=wearingMarking(a)
markingCarlon=markWearing(a)
head(a)
head(markingCarlon)
str(markingCarlon$isWearing)
levels(as.factor(str(markingCarlon$isWearing))
)
levels(as.factor(markingCarlon$isWearing)
)
table(markingCarlon)
table(markingCarlon$isWearing)
head(markingCarlon)
write.csv("/tmp/carlon.csv", markingCarlon)
?write.csv
write.csv(file="/tmp/carlon.csv", markingCarlon)
write.csv(file="/tmp/standard.csv", markingStandard)
table(markingStandard$wearing)
b=wearingMarking(a,
perMinuteCts=1
)
markingStandard=wearingMarking(a,
perMinuteCts=1
)
table(markingStandard$wearing)
write.csv(file="/tmp/standard.csv", markingStandard)
?filelist
??filelist
?files
source('/mnt/raid/home/dewoller/mydoc/research/noraShields/projects/foot_health_2015/do.R')
a=processOneFile("data/AL_1st_Nov_2013_foot_health_study.csv
")
a=processOneFile("data/AL_1st_Nov_2013_foot_health_study.csv")
list.files("base/")
list.files(path="base/")
pwd()
dir("./base")
dir("./data")
data.frame(dir("./data"))
names(data.frame(dir("./data")))
?data.frame
source('/mnt/raid/home/dewoller/mydoc/research/noraShields/projects/foot_health_2015/do.R')
a=processDirectory()
path = "data/"
,
pattern = '*.csv'
,
searchPattern="^([A-Z]+)_.*"
) {
files =data.frame(list.files( path, pattern));
names(files)=c("filename");
files$base = gsub(searchPattern, "\\1", files$filename);
files$fullPath= paste(path, files$filename, sep="");
files
names(files)
head(files)
processFiles( files);
processFiles( files);
names(dayDetail)
5
source('/mnt/raid/home/dewoller/mydoc/research/noraShields/projects/foot_health_2015/do.R')
q
0
exit
0
a
quit
quit()
source('/mnt/raid/home/dewoller/mydoc/research/noraShields/projects/foot_health_2015/do.R')
processFilesNora(fileNameCSV="data/test.csv")
a=processFilesNora(fileNameCSV="data/test.csv")
source('/mnt/raid/home/dewoller/mydoc/research/noraShields/projects/foot_health_2015/do.R')
a=processFilesNora(fileNameCSV="test.csv")
source('/mnt/raid/home/dewoller/mydoc/research/noraShields/projects/foot_health_2015/do.R')
a=processFilesNora(fileNameCSV="test.csv")
a=processFilesNora()
head(a)
a=processFilesNora(fileNameCSV="test.csv")
source('/mnt/raid/home/dewoller/mydoc/research/noraShields/projects/foot_health_2015/do.R')
a=processFilesNora(fileNameCSV="test.csv")
summary(a)
summary(a$peopleRows)
fileNameCSV="test.csv"
basePath="~/mydoc/research/noraShields/projects/foot_health_2015/"
defaultDateFormat="%m/%d/%Y"
rv=list()
files=read.csv(paste(basePath, fileNameCSV, sep=""),stringsAsFactors=FALSE)
files$base=files$filename
files$chunk=files$filename
files$fullPath=paste(basePath, files$filename, sep="")
thresholds=c(247,275,302,832,926,1018)
peopleRows=list()
dayDetails=data.frame()
for(i in 1:length(files[,1])){
print(paste("processing row",i,files[i,]$fullPath))
}
i=1
csv = readCountsDataRT3(files[i,]$fullPath , df )
head(csv)
files
df="%d/%m/%Y"
df = defaultDateFormat
csv = readCountsDataRT3(files[i,]$fullPath , df )
head(csv)
str(a)
names(a$peopleRows)
names(a$PeopleRows)
str(a$peopleRows)
summary(a$peopleRows)
head(csv)
as.date(csv$TimeStamp)
as.character.Date(csv$TimeStamp)
floor(csv$TimeStamp)
min(csv$TimeStamp)
max(csv$TimeStamp)
fileRow= markCompliant(csv, files[i,]$fullPath)
fileRow
names(fileRow)
fileRow[,-"csv")
fileRow[,-"csv"]
fileRow[-"csv"]
fileRow[-9]
fileRow$csv$days
csv$days
names(csv)
csv=fileRow$csv
names(csv)
csv$day
levels(csv$day)
summary(csv)
ddply(subset(csv, csv$isWeekEnd), .day, summarise, isWearing)
ddply(subset(csv, csv$isWeekEnd), .(day), summarise, isWearing)
ddply(subset(csv, csv$isWeekEnd), .(day), summarise, table(isWearing))
table(subset(csv, csv$isWeekEnd)))
table(subset(csv, csv$isWeekEnd))
table(subset(csv, csv$isWeekEnd, select=c("isWearing")))
table(subset(csv, csv$isWeekEnd, select=c("isWearing", "day")))
table(subset(csv, csv$isWeekEnd, select=c("isCompliant", "day")))
table(subset(csv, csv$isWeekEnd, select=c("isWearing", "day")))
a=processFilesNora(fileNameCSV="test.csv")
dim(a)
str(a)
rm()
rm(list=ls())
a=processFilesNora(fileNameCSV="test.csv")
source('/mnt/raid/home/dewoller/mydoc/research/noraShields/projects/foot_health_2015/do.R')
source('/mnt/raid/home/dewoller/mydoc/research/noraShields/projects/foot_health_2015/do.R')
a=processFilesNora(fileNameCSV="test.csv")
a=processFilesNora(fileNameCSV="test.csv")
a=processFilesNora(fileNameCSV="test.csv")
str(a)
str(a$peopleRows)
str(a$peopleRows$csv)
str(a$peopleRows[1]$csv)
str(a$peopleRows[1])
str(a$peopleRows[[1]])
str(a$peopleRows[[1,1]])
str(a$peopleRows[[2]])
str(a$peopleRows[[3]])
str(a$peopleRows[[5]])
b=a$peopleRows
str(a$peopleRows[1])
str(a$peopleRows[[1]])
str(a$peopleRows)
summary(a$peopleRows)
summary(a$peopleRows$csv)
summary(b$csv)
summary(b)
summary(b[1])
summary(b[[1]])
class(b)
dim(b)
summary(b[2,2])
b[2,2]
b[1,9]
table(subset(b[1,9], csv$isWeekEnd, select=c("isWearing", "day")))
csv=b[1,9]; table(subset(csv, csv$isWeekEnd, select=c("isWearing", "day")))
str(csv)
csv=b[1,9][[1]]; table(subset(csv, csv$isWeekEnd, select=c("isWearing", "day")))
??for
;
??for
;ljk
?for
;
csv=b[,9][[1]]
dim(csv)
type(csv)
str(csv)
csv=b[,9]
str(csv)
typeof(csv)
dim(csv)
f=function(csv) {table(subset(csv, csv$isWeekEnd, select=c("isWearing", "day")))}
f(csv[[1]])
lapply(csv, f)
hed(csv[[1]])
head(csv[[1]])
tail(csv[[1]])
head(csv[[1]]$day)
head(levels(as.factor(csv[[1]]$day)))
levels(as.factor(csv[[1]]$day))
csv[[1]]$myWear=csv[[1]]$counts>10
f=function(csv) {table(subset(csv, csv$isWeekend, select=c("counts", "day")))}
load("graphics")
require("graphics")
?hist
f=function(csv) {hist(subset(csv, csv$isWeekend, select=c("counts", "day")))}
f(csv[[1]])
hist(subset(csv[[1]], csv[[1]]$isWeekEnd, select=c("counts", "day")))}
hist(subset(csv[[1]], csv[[1]]$isWeekEnd, select=c("counts", "day")))
hist(subset(csv[[1]], csv[[1]]$isWeekEnd, select=c("counts")))
subset(csv[[1]], csv[[1]]$isWeekEnd, select=c("counts"))
a=subset(csv[[1]], csv[[1]]$isWeekEnd, select=c("counts"))
hist(a)
typeof(a)
head(a)
as.vector(a)
a=as.vector(subset(csv[[1]], csv[[1]]$isWeekEnd, select=c("counts")))
hist(a)
head(a)
hist(a$counts)
f=function(csv) {as.vector(subset(csv, csv$isWeekend & csv$counts>0, select=c("counts")))}
f(csv[[1]])
f=function(csv) {as.vector(subset(csv, csv$isWeekEnd & csv$counts>0, select=c("counts")))}
f(csv[[1]])
hist(f(csv[[1]]))
hist(f(csv[[1]])$counts)
hist(f(csv[[1]])$counts, c(10,100))
hist(f(csv[[1]])$counts, c(0,10,100))
hist(f(csv[[1]])$counts, c(0,10,100,10000))
hist(f(csv[[1]])$counts, c(0,10,100,1000))
hist(f(csv[[1]])$counts, c(0,10,1000))
hist(f(csv[[1]])$counts, c(0,10,1000000))
max(f(csv[[1]])$counts)
hist(f(csv[[1]])$counts, c(0,10,3800))
hist(f(csv[[1]])$counts)
b=hist(f(csv[[1]])$counts)
b
b=hist(f(csv[[1]])$counts, freq=TRUE)
b=hist(f(csv[[1]])$counts, breaks=c(0,10,10000), xlim=c(0,200), freq=TRUE)
b=hist(f(csv[[1]])$counts, breaks=c(0,10,10000), xlim=c(0,100), freq=TRUE)
b=hist(f(csv[[1]])$counts, breaks=c(0,10,100,10000), xlim=c(0,100), freq=TRUE)
b=hist(f(csv[[2]])$counts, breaks=c(0,10,100,10000), xlim=c(0,100), freq=TRUE)
b=hist(f(csv[[3]])$counts, breaks=c(0,10,100,10000), xlim=c(0,100), freq=TRUE)
?subset
f=function(csv) {as.vector(subset(csv, csv$isWeekEnd & csv$counts>0, select=c("counts")))}
f=function(csv) {table(subset(csv, csv$isWeekEnd, select=c("isWearing", "day")))}
f=function(csv) {a=subset(csv, csv$isWeekEnd, select=c("isWearing", "counts", "day"))); a$mwear=counts>10; table(a$mwear)}
f=function(csv) {a=subset(csv, csv$isWeekEnd, select=c("isWearing", "counts", "day")); a$mwear=counts>10; table(a$mwear)}
f(csv[[1]])
f=function(csv) {a=subset(csv, csv$isWeekEnd, select=c("isWearing", "counts", "day")); a$mwear=a$counts>10; table(a$mwear)}
f(csv[[1]])
f(csv[[2]])
f(csv[[3]])
f=function(csv) {a=subset(csv, csv$isWeekEnd, select=c("isWearing", "counts", "day")); a$mwear=a$counts>10; table(a$mwear, a$day)}
f(csv[[1]])
f(csv[[2]])
f(csv[[3]])
f(csv[[4]])
f=function(csv) {a=subset(csv, csv$isWeekEnd, select=c("isWearing", "counts", "day")); a$mwear=a$counts>0; table(a$mwear, a$day)}
lapply(csv,f)
source('/mnt/raid/home/dewoller/mydoc/research/noraShields/projects/foot_health_2015/do.R')
a=processFilesNora(fileNameCSV="test.csv")
a=processFilesNora()
a=processFilesNora()
a=c(1,2,3,4)
a
sum(a)
mean(a)
sd(a)
a+1
a==4
a[ a==4 ]
a[ a==4 ] <=9
a[ a==4 ] <-9
a
a[ a==4 ] =9
min(a)
a==min(a)
subset(a, select=a==min(a))
library(plyr)
subset(a, select=a==min(a))
rand(100)
c("a", "B")
data.frame(1,2,3)
read.csv("/tmp/a.csv")
read.csv("/tmp/2015-07-27.csv")
a=read.csv("/tmp/2015-07-27.csv")
summary(a)
a$C1
a$C3=as.factor(a$C1)
summary(a)
a$C4=as.numeric(a$C3)
summary(a)
a
a$C3+a$C4
a$C1+a$C4
str(a)
b=list()
b
b=list(a)
b
b=list(a,a,a,)
b=list(a,a,a)
b
b[[1]]
?ddply
??manova
?ddply
dfx <- data.frame(
group = c(rep('A', 8), rep('B', 15), rep('C', 6)),
sex = sample(c("M", "F"), size = 29, replace = TRUE),
age = runif(n = 29, min = 18, max = 54)
)
dfx
summary(dfx)
ddply(dfx, .(sex), summarise, mean=mean(age))
ddply(dfx, .(group,sex), summarise, mean=mean(age))
ddply(dfx, .(group,sex), summarise, mean=length(age))
dfx <- data.frame(
group = c(rep('A', 8), rep('B', 15), rep('C', 6)),
sex = sample(c("M", "F"), size = 29, replace = TRUE),
age = runif(n = 29, min = 18, max = 54), reaction=runif(n=29, min=0, max=10)
)
dfx
melt(dfx)
library(reshape)
melt(dfx)
source('~/.active-rstudio-document', echo=TRUE)
group = c(rep('A', 8), rep('B', 15), rep('C', 6)),
dfx <- data.frame(
group = c(rep('A', 8), rep('B', 15), rep('C', 6)),
sex = sample(c("M", "F"), size = 29, replace = TRUE),
age = runif(n = 29, min = 18, max = 54), reaction=runif(n=29, min=0, max=10)
)
?manova
lm
?lm
dfx
head(dfx)
names(dfx)
lm(reaction ~ age, dfx)
str(dfx)
b=
lm(reaction ~ age, dfx)
summary(b)
plot(b)
