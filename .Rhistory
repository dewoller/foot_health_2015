?physicalActivity
??physicalActivity
a=read.csv("test.csv")
names(a)
head(a)
library("PhysicalActivity");
source('/mnt/raid/home/dewoller/mydoc/research/noraShields/projects/foot_health_2015/functions.R')
a=readCountsDataRT3("test.csv")
head(a)
names(a)
filename=("test.csv")
Tfile <- file(filename, "r")
if (isOpen(Tfile, "r")) {
seek(Tfile, 0, rw = "r")
lines = readLines(Tfile)
close(Tfile)
}
skipPos = grep("Entry", lines)[1]
head(lines)
head(lines,20)
??grep
str(lines)
lines[1]
lines[1:20]
skipPos = grep("Entry", lines[1:22])[1]
skipPOs
skipPos
startTPos = grep("Start Time[1:22]", lines)
startTime = gsub("Start Time,", "", lines[startTPos])
startTime = gsub(",", " ", startTime)
startTime
startTPos = grep("Start Time", lines[1:22])
startTime = gsub("Start Time,", "", lines[startTPos])
startTime = gsub(",", " ", startTime)
startTime
trim(startTime)
strim(startTime)
??trim
str_trim(startTime)
require("stringr")
str_trim(startTime)
startline = skipPos + 1
endline = length(lines)
rawdata = c()
for (i in startline:endline) {
rawdata = c(rawdata, strsplit(lines[i], ",") [[1]][6])
}
timeline = rep(0:as.integer(length(rawdata)-1))*60
rst = timeline + as.POSIXlt(startTime, tz="", "%m/%d/%Y %H:%M:%s")
head(rst)
startTime
?as.POSIXlt
startTime
as.POSIXlt(startTime, tz="", "%m/%d/%Y %H:%M:%s")
as.POSIXlt(startTime, tz="", "%m/%d/%Y %H:%M:%s")
as.POSIXlt(str_trim(startTime), tz="", "%m/%d/%Y %H:%M:%s")
as.POSIXlt(str_trim(startTime), tz="", "%D %H:%M:%s")
as.POSIXlt("str_trim(startTime)"01/01/2001", tz="", "%m/%d/%Y")
as.POSIXlt("01/01/2001", tz="", "%m/%d/%Y")
as.POSIXlt(str_trim(startTime), tz="", "%m-%d-%Y %H:%M:%s")
startTime
as.POSIXlt(str_trim(startTime), tz="", "%m/%d/%Y %H:%M:%s")
as.POSIXlt(str_trim(startTime), tz="", "%m/%d/%Y")
as.POSIXlt(str_trim(startTime), tz="", "%m/%d/%Y %H")
as.POSIXlt(str_trim(startTime), tz="", "%m/%d/%Y %H:%M")
as.POSIXlt(str_trim(startTime), tz="", "%m/%d/%Y %H:%M:%s")
as.POSIXlt(str_trim(startTime), tz="", "%m/%d/%Y %H:%M:%S")
################################################################################
readCountsDataRT3 = function (filename)
{
Tfile <- file(filename, "r")
if (isOpen(Tfile, "r")) {
seek(Tfile, 0, rw = "r")
lines = readLines(Tfile)
close(Tfile)
}
skipPos = grep("Entry", lines[1:22])[1]
startTPos = grep("Start Time", lines[1:22])
startTime = gsub("Start Time,", "", lines[startTPos])
startTime = gsub(",", " ", startTime)
startline = skipPos + 1
endline = length(lines)
rawdata = c()
for (i in startline:endline) {
rawdata = c(rawdata, strsplit(lines[i], ",") [[1]][6])
}
timeline = rep(0:as.integer(length(rawdata)-1))*60
rst = timeline + as.POSIXlt(startTime, tz="", "%m/%d/%Y %H:%M:%S")
data.frame(TimeStamp = rst, counts = as.numeric(as.vector(rawdata)))
}
a=readCountsDataRT3("test.csv")
head(a)
source('/mnt/raid/home/dewoller/mydoc/research/noraShields/projects/foot_health_2015/functions.R')
b=wearingMarking(a)
head(a)$TimeStamp
head(a)$TimeStamp[1]
strptime(head(a)$TimeStamp[1], "%Y")
strptime(head(a)$TimeStamp[1], "%y")
as.character(head(a)$TimeStamp[1], "%y")
as.character(head(a)$TimeStamp[1], "%Y")
as.character(head(a)$TimeStamp[1], "%Y-%M")
as.character(head(a)$TimeStamp[1], "%Y-%m")
as.character(head(a)$TimeStamp[1], "%Y-%m-%d")
as.character(head(a)$TimeStamp[1], "%Y-%m-%d %H:%M:%S")
source('/mnt/raid/home/dewoller/mydoc/research/noraShields/projects/foot_health_2015/functions.R')
a=readCountsDataRT3("test.csv")
str(a)
source('/mnt/raid/home/dewoller/mydoc/research/noraShields/projects/foot_health_2015/functions.R')
a=readCountsDataRT3("test.csv")
str(a)
b=wearingMarking(a)
source('/code/noraShields/projects/foot_health_2015/load.R')
traceback()
options(error=recover)
source('/code/noraShields/projects/foot_health_2015/load.R')
b=wearingMarking(a)
head(ts)
head(TS)
TS
0
source('/code/noraShields/projects/foot_health_2015/functions.R')
source('/mnt/raid/home/dewoller/mydoc/research/noraShields/projects/foot_health_2015/functions.R')
a=readCountsDataRT3("test.csv")
source('~/.active-rstudio-document', echo=TRUE)
b=wearingMarking(a)
head(b)
str(b)
b=wearingMarking(a, perMinuteCts=1)
str(b)
as.factor(b$weekday)
str(b)
source('/code/noraShields/projects/foot_health_2015/load.R', echo=TRUE)
library("PhysicalActivity");
source("functions.R")
a=readCountsDataRT3("test.csv")
head(b)
(a)
b=wearingMarking(a, perMinuteCts=1)
head(b)
levels(as.factor(b$w))
levels(as.factor(b$wearing))
dataset=a
frame = 90,
perMinuteCts = 60,
TS = "TimeStamp",
cts = "counts",
streamFrame = NULL,
allowanceFrame= 2,
newcolname = "wearing",
getMinuteMarking = FALSE,
dayStart = "00:00:00",
dayEnd = "23:59:59",
)
b=wearingMarking(a,
)
perMinuteCts=1
frame = 90
,
perMinuteCts = 60
,
TS = "TimeStamp"
,
cts = "counts"
,
streamFrame = NULL
,
allowanceFrame= 2
,
newcolname = "wearing"
,
getMinuteMarking = FALSE
,
dayStart = "00:00:00"
,
dayEnd = "23:59:59"
,
...)
perMinuteCts=1
if(perMinuteCts != 1){
#not a minute data run collapse
data2 = dataCollapser(dataset, TS=TS, by = 60, col = cts, ...)
}else{
data2 = dataset
}
cat("frame is ", frame, "\n")
cat("streamFrame is ", streamFrame, "\n")
cat("allowanceFrame is ", allowanceFrame, "\n")
ct = as.vector(dataset[,names(dataset) == cts])
if(is.null(streamFrame)){
streamFrame = round(0.5*frame)
}
#all the NA's in the original counts data will be treated as 0 counts
ct1 = ct
ct[is.na(ct)] = 0
size = dim(dataset)[1]
wearing = rep("nw", size)
ct_bool = ct > 0
rowPos = nthOccurance (dataVct = ct_bool, value= TRUE)
library("PhysicalActivity");
rowPos = nthOccurance (dataVct = ct_bool, value= TRUE)
source("PhysicalActivity/R/nthOccurance.R")
rowPos = nthOccurance (dataVct = ct_bool, value= TRUE)
head(rowPos)
head(ct_bool)
str(rowPos)
str(ct_bool)
startpos = rowPos[1]
endpos = c()
prev = TRUE
for(q  in 2: (length(rowPos)))
{
if(prev)
{
if( rowPos[q] - rowPos[q-1]>1 )
{
endpos = c(endpos, rowPos[q-1])
startpos = c(startpos, rowPos[q])
}
}
else
{
startpos = c(startpos, rowPos[q])
prev = TRUE
}
if(q == length(rowPos))
{endpos = c(endpos, rowPos[q])}
}#end of q
len(endpos)
str(endpos)
str(startpos)
head(ct_bool)
allowancewin = endpos-startpos
head(allowancewin)
source('/mnt/raid/home/dewoller/mydoc/research/noraShields/projects/foot_health_2015/functions.R')
source("/home/dewoller/mydoc/research/noraShields/students/carlon/stats/func.R")
markingStandard=b
markingCarlon=wearingMarking(a)
markingCarlon=markWearing(a)
head(a)
head(markingCarlon)
str(markingCarlon$isWearing)
levels(as.factor(str(markingCarlon$isWearing))
)
levels(as.factor(markingCarlon$isWearing)
)
table(markingCarlon)
table(markingCarlon$isWearing)
head(markingCarlon)
write.csv("/tmp/carlon.csv", markingCarlon)
?write.csv
write.csv(file="/tmp/carlon.csv", markingCarlon)
write.csv(file="/tmp/standard.csv", markingStandard)
table(markingStandard$wearing)
b=wearingMarking(a,
perMinuteCts=1
)
markingStandard=wearingMarking(a,
perMinuteCts=1
)
table(markingStandard$wearing)
write.csv(file="/tmp/standard.csv", markingStandard)
